jQuery(function(a){function b(){"undefined"!=typeof console.log&&console.log.apply(console,arguments)}function c(a){var b="";return"object"!=typeof a?b:("function"==typeof a.getErrorCode&&(b+="("+a.getErrorCode()+") "),"function"==typeof a.getErrorMessage&&(b+=a.getErrorMessage()),b)}function d(){if(amazon&&amazon_payments_advanced_params.is_checkout&&amazon_payments_advanced_params.access_token){if(0===a(".create-account").length)return;amazon.Login.authorize({scope:"profile",interactive:"never"},function(c){return c.error?b("Error encountered in amazon.Login.authorize:",c.error):void amazon.Login.retrieveProfile(function(c){if(c.success){var d=c.profile.Name.split(" ");a("#billing_first_name").val(d.shift()),a("#billing_last_name").val(d.join(" ")),a("#billing_email").val(c.profile.PrimaryEmail)}else b("Error encountered in amazon.Login.retrieveProfile:",c)})})}}function e(b){if(!l){l=b.getAmazonOrderReferenceId(),a("input.amazon-reference-id").remove();var c='<input class="amazon-reference-id" type="hidden" name="amazon_reference_id" value="'+l+'" />';a("form.checkout").append(c),a("form#order_review").append(c)}}function f(b){if(!m){m=b.getAmazonBillingAgreementId();var c='<input class="amazon-billing-agreement-id" type="hidden" name="amazon_billing_agreement_id" value="'+m+'" />';a("form.checkout").append(c),a("form#order_review").append(c),a("#amazon_consent_widget").show()}}function g(){if(!o&&0!==a("#pay_with_amazon").length){var d={type:amazon_payments_advanced_params.button_type,color:amazon_payments_advanced_params.button_color,size:amazon_payments_advanced_params.button_size,authorization:function(){loginOptions={scope:"profile postal_code payments:widget payments:shipping_address payments:billing_address"},k=amazon.Login.authorize(loginOptions,amazon_payments_advanced_params.redirect)},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Button",d?": "+d:"")}};""!==amazon_payments_advanced_params.button_language&&(d.language=amazon_payments_advanced_params.button_language),OffAmazonPayments.Button("pay_with_amazon",amazon_payments_advanced_params.seller_id,d),o=!0}}function h(){var d={sellerId:amazon_payments_advanced_params.seller_id,onReady:function(){i(),a(document).trigger("wc_amazon_pa_widget_ready")},onOrderReferenceCreate:e,onAddressSelect:function(b){a("body").trigger("update_checkout")},design:{designMode:"responsive"},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.AddressBook",d?": "+d:"")}};amazon_payments_advanced_params.is_recurring&&(d.agreementType="BillingAgreement",d.onReady=function(b){f(b),i(),j(),a(document).trigger("wc_amazon_pa_widget_ready")}),new OffAmazonPayments.Widgets.AddressBook(d).bind("amazon_addressbook_widget")}function i(){var a={sellerId:amazon_payments_advanced_params.seller_id,design:{designMode:"responsive"},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.Wallet",d?": "+d:"")}};n||(a.onOrderReferenceCreate=e),amazon_payments_advanced_params.is_recurring&&(a.agreementType="BillingAgreement",m?a.amazonBillingAgreementId=m:a.onReady=function(a){f(a),j()}),new OffAmazonPayments.Widgets.Wallet(a).bind("amazon_wallet_widget")}function j(){amazon_payments_advanced_params.is_recurring&&m&&new OffAmazonPayments.Widgets.Consent({sellerId:amazon_payments_advanced_params.seller_id,amazonBillingAgreementId:m,design:{designMode:"responsive"},onConsent:function(b){var c=b.getConsentStatus();a("#place_order").css("opacity","true"==c?1:.5),a("#place_order").prop("disabled","true"!=c)},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.Consent",d?": "+d:"")}}).bind("amazon_consent_widget")}var k,l,m,n,o=!1;d(),g(),n=a("#amazon_addressbook_widget").length>0,n?h():i(),a("body").on("click","#amazon-logout",function(a){amazon.Login.logout()}),a("form.checkout").on("checkout_place_order",function(){var b=[":input[name=billing_email]",":input[name=billing_first_name]",":input[name=billing_last_name]",":input[name=account_username]",":input[name=account_password]",":input[name=createaccount]"].join(",");a(this).find(b).each(function(){var b=a(this);""===b.val()&&b.is(":hidden")&&b.attr("disabled","disabled"),"createaccount"===b.attr("name")&&a("#createaccount").length&&b.prop("checked",a("#createaccount").is(":checked"))})}),a("body").on("updated_checkout",g),a("body").on("updated_cart_totals",function(){o=!1,g()})});